# 面试题

###  JS 超过Number 最大值的数怎么处理

```js
// BigInt

const bigNum = BigInt('13123123123123123123123123123123');

bigNum + bigNum


// decimal
const decimal = new Decimal("1e+308")


// 用户输入限制大小
```


### 页面请求接口大规模并发问题

数据采集平台，交互强平台， 有序相对稳定发送到后端

```js
// 请求队列

class RequestQueue {
  constructor(maxConcurrent){
    this.maxConcurrent = maxConcurrent; // 最大并发请求数
    this.currentConcurrent = 0;
    this.queue = []; // 请求队列
  }
  
  add(request){
    return new Promise((resolve,reject) => {
      this.queue.push({ request, resolve, reject });
      this.processQueue();
    });
  }

  processQueue(){
    if (this.queue.length > 0 && this.currentConcurrent < this.maxConcurrent ){
      this.currentConcurrent++;
      request()
        .then(resolve)
        .catch(reject)
        .finally(() => {
          this.currentConcurrent--;
          this.processQueue();
        })
    }
  }
}

function fetchData(url) {
  return fetch(url).then(res => res.json);
}

// 使用请求队列
const requestQueue = new RequestQueue(5); // 设定最大并发请求数为5

const urls =[
  'http://api1..',
  'http://api2..',
]

const requests = urls.map(url => () => fetchData(url));

Promise.all(requests.map(request => requestQueue.add(request)))
  .then(results => {
    console.log('所有请求完成', requests)
  })
  .catch(error => console.log('请求失败', error))

```

防抖/节流
```js
// 防抖 debounce : 确保在指定时间内函数只执行一次，常用于输入框的搜索建议。
function debounce(func,wait) {
  let timeout;
  return function(..args){
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      func.apply(this.args);
    },wait)
  }
}

const debounceFetchData = debounce((query)=> {
  fetchData('api/...').then(data => console.log(data))
},300)

document.getElementById('search-input').addEventListener('input', event => debounceFetchData(e.target.value))

// 节流 throttle : 确保在指定时间间隔内函数执行一次，常用于窗口的resize,scroll事件。

function throttle(func, limit){
  let inThrottle;
  return function (...args){
    if (!inThrottle) {
      func.apply(this,args);
      inThrottle = true;
      setTimeout(() => inThrottle = false, limit);
    }
  }
}

const throttleFetchData = throttle((query)=> {
  fetchData('api/...').then(data => console.log(data))
},1000)

window.addEventListener('scroll', throttleFetchData)
```

// 分页加载

```js
let currentPage = 1;
const pageSize = 20;
let isLoading = false;

function loadMoreData(){
  if (isLoading) return;
  isLoading = true;

  fetch(`/api.../?page=${currentPage}&size=${pageSize}`)
    .then(res => res.json)
    .then(data => {
      const container = document.getElementById('item-container');
      data.items.forEach(item => {
        const itemElement = document.createElement('div');
        itemElement.textContent = item.name;
        container.appendChild(itemElement);
      })

      currentPage++;
      isLoading = false;
    })
    .catch(error =>{
      isLoading = false;
    })
}

window.addEventListener('scroll', () => {
  if (window.innerHeight + window.scrollY >= document.body.offsetHeight){
    loadMoreData();
  }
})

```